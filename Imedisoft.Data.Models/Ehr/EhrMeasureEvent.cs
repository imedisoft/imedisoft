using Imedisoft.Data.Annotations;
using System;

namespace Imedisoft.Data.Models
{
    /// <summary>
	/// Represents events for EHR that are needed for reporting purposes.
	/// </summary>
    [Table("ehr_measure_events")]
	public class EhrMeasureEvent
	{
		[PrimaryKey]
		public long Id;

		/// <summary>
		/// The date and time the event ocurred.
		/// </summary>
		[Column(AutoGenerated = true)]
		public DateTime Date;

		public EhrMeasureEventType Type;

		public long? PatientId;

		/// <summary>
		/// More information about the event. Not typically used.
		/// </summary>
		public string MoreInfo;

		/// <summary>
		///		<para>
		///			The code for this event. The event code typically represents a question.
		///		</para>
		///		<para>
		///			Example: <see cref="EhrMeasureEventType.TobaccoUseAssessed"/> can be one of 
		///			three LOINC codes:
		///			<list type="table">
		///				<item><term>11366-2</term> History of tobacco use Narrative</item>
		///				<item><term>68535-4</term> Have you used tobacco in the last 30 days</item>
		///				<item><term>68536-2</term> Have you used smokeless tobacco product in the last 30 days.</item>
		///			</list>
		///		</para>
		/// </summary>
		public string EventCode;

		/// <summary>
		///		<para>
		///			The code system name for the event code (e.g. 'LOINC', 'SNOMEDCT').
		///		</para>
		/// </summary>
		public string EventCodeSystem;

		/// <summary>
		///		<para>
		///			The code for this event result.
		///		</para>
		///		<para>
		///			Example: A <see cref="EhrMeasureEventType.TobaccoUseAssessed"/> event type 
		///			could result in a finding of SNOMED code 8517006 (ex-smoker). There 
		///			are 54 allowed tobacco user/non-user codes, and the user is allowed to select 
		///			from any SNOMED code if they wish, for a 
		///			<see cref="EhrMeasureEventType.TobaccoUseAssessed"/> event.
		///		</para>
		/// </summary>
		public string ResultCode;

		/// <summary>
		///		<para>
		///			The code system name for the event result (e.g. 'LOINC', 'SNOMEDCT').
		///		</para>
		/// </summary>
		public string ResultCodeSystem;

		/// <summary>
		///		<para>
		///			A foreign key to a table associated with the event. NULL indicates not in use.
		///		</para>
		///		<para>
		///			Used to properly count denominators for specific measure types.
		///		</para>
		/// </summary>
		public long? ObjectId;

		/// <summary>
		/// The date the patient started using tobacco.
		/// </summary>
		public DateTime? TobaccoStartDate;

		/// <summary>
		/// How eager a tobacco user is to quit using tobacco. Scale of 1-10.
		/// </summary>
		public byte TobaccoCessationDesire;
	}


	public enum EhrMeasureEventType
	{
		EducationProvided,
		OnlineAccessProvided,
		ElectronicCopyRequested,
		ElectronicCopyProvidedToPt,
		ClinicalSummaryProvidedToPt,
		ReminderSent,
		MedicationReconcile,

		/// <summary>
		/// When Summary of Care is provided in one of the following ways: Printed, exported, or sent to the patient portal (for referrals To doctors).
		/// </summary>
		SummaryOfCareProvidedToDr,

		TobaccoUseAssessed,
		TobaccoCessation,
		CurrentMedsDocumented,
		CPOE_MedOrdered,
		CPOE_LabOrdered,
		CPOE_RadOrdered,

		/// <summary>
		/// When a Summary of Care is provided to a doctor electronically in one of the following ways: Exported (we assume they send another way), or a Direct message is sent with Summary of Care attached.
		/// </summary>
		SummaryOfCareProvidedToDrElectronic,
		
		SecureMessageFromPat,
		DrugDrugInteractChecking,
		DrugFormularyChecking,
		ProtectElectHealthInfo,
		ImmunizationRegistries,
		SyndromicSurveillance,
		PatientList,
		ClinicalInterventionRules
	}
}